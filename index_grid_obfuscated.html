<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CCRI CTF Flag Tracker</title>
    <style>
        body { font-family: Arial, sans-serif; background-color: #f2f2f2; padding: 20px; }
        h1 { text-align: center; }
        #challenges { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin-top: 20px; }
        .challenge { background: #fff; padding: 10px; border-radius: 5px; box-shadow: 0 0 5px #ccc; }
        .complete input { background-color: #d4edda; }
        input[type="text"] { width: 90%; padding: 5px; }
        .status { font-weight: bold; margin-left: 5px; }
        input.invalid { background-color: #f8d7da; }
    </style>
</head>
<body>
    <h1>CCRI CTF Flag Tracker</h1>
    <p>Enter the flag you found for each challenge below. Your progress will be saved automatically in your browser.</p>
    <p><strong>Flag Format:</strong> CCRI-AAAA-1111</p>
    <h2 id="progress">0 of 7 challenges completed</h2>

    <div id="challenges">
        <div class="challenge" id="#01 Stego-container">
            <label for="#01 Stego"><strong>#01 Stego</strong></label><br>
            <input type="text" id="#01 Stego" maxlength="15" oninput="validate('#01 Stego')">
            <span class="status" id="#01 Stego-status"></span>
        </div>
        <div class="challenge" id="#02 Base64-container">
            <label for="#02 Base64"><strong>#02 Base64</strong></label><br>
            <input type="text" id="#02 Base64" maxlength="15" oninput="validate('#02 Base64')">
            <span class="status" id="#02 Base64-status"></span>
        </div>
        <div class="challenge" id="#03 ROT13-container">
            <label for="#03 ROT13"><strong>#03 ROT13</strong></label><br>
            <input type="text" id="#03 ROT13" maxlength="15" oninput="validate('#03 ROT13')">
            <span class="status" id="#03 ROT13-status"></span>
        </div>
        <div class="challenge" id="#04 Vigenère-container">
            <label for="#04 Vigenère"><strong>#04 Vigenère</strong></label><br>
            <input type="text" id="#04 Vigenère" maxlength="15" oninput="validate('#04 Vigenère')">
            <span class="status" id="#04 Vigenère-status"></span>
        </div>
        <div class="challenge" id="#05 Archive Password-container">
            <label for="#05 Archive Password"><strong>#05 Archive Password</strong></label><br>
            <input type="text" id="#05 Archive Password" maxlength="15" oninput="validate('#05 Archive Password')">
            <span class="status" id="#05 Archive Password-status"></span>
        </div>
        <div class="challenge" id="#06 Hashcat-container">
            <label for="#06 Hashcat"><strong>#06 Hashcat</strong></label><br>
            <input type="text" id="#06 Hashcat" maxlength="15" oninput="validate('#06 Hashcat')">
            <span class="status" id="#06 Hashcat-status"></span>
        </div>
        <div class="challenge" id="#07 Extract from Binary-container">
            <label for="#07 Extract from Binary"><strong>#07 Extract from Binary</strong></label><br>
            <input type="text" id="#07 Extract from Binary" maxlength="15" oninput="validate('#07 Extract from Binary')">
            <span class="status" id="#07 Extract from Binary-status"></span>
        </div>
    </div>

    <script>
        const xorKeyBase64 = "Q1RGNEVWRVI=";
        const xorKey = atob(xorKeyBase64);

        const correctFlags = {
            "#01 Stego": "ABcUfWgFERcEeXcMcWQ=",
            "#02 Base64": "ABcUfWgUFBcbeXQFdWQ=",
            "#03 ROT13": "ABcUfWgECgYNeXUHdWU=",
            "#04 Vigenère": "ABcUfWgADBUaeXINd2M=",
            "#05 Archive Password": "ABcUfWgXFxELeXUAcm8=",
            "#06 Hashcat": "ABcUfWgMDAITeXMAdWc=",
            "#07 Extract from Binary": "ABcUfWgUDBwCeXEEfGc=",
        };

        function xorDecrypt(encodedBase64, key) {
            const data = atob(encodedBase64);
            let result = '';
            for (let i = 0; i < data.length; i++) {
                result += String.fromCharCode(data.charCodeAt(i) ^ key.charCodeAt(i % key.length));
            }
            return result;
        }

        function updateProgress() {
            let complete = 0;
            Object.keys(correctFlags).forEach(id => {
                const input = document.getElementById(id);
                const stored = localStorage.getItem(id);
                const container = document.getElementById(id + "-container");
                const status = document.getElementById(id + "-status");
                const correct = xorDecrypt(correctFlags[id], xorKey);

                if (!stored || stored === "") {
                    container.classList.remove("complete");
                    input.classList.remove("invalid");
                    status.textContent = "";
                    return;
                }

                const isValid = /^CCRI-[A-Z]{4}-[0-9]{4}$/.test(stored);
                if (!isValid) {
                    container.classList.remove("complete");
                    input.classList.add("invalid");
                    status.textContent = "❌ Invalid format";
                    status.style.color = "red";
                } else if (stored.toUpperCase() === correct) {
                    input.value = stored;
                    container.classList.add("complete");
                    input.classList.remove("invalid");
                    status.textContent = "✓ Correct";
                    status.style.color = "green";
                    complete++;
                } else {
                    container.classList.remove("complete");
                    input.classList.remove("invalid");
                    status.textContent = "";
                }
            });
            document.getElementById("progress").textContent = complete + " of 7 challenges completed";
        }

        function validate(id) {
            const input = document.getElementById(id);
            const value = input.value.trim().toUpperCase();
            localStorage.setItem(id, value);
            updateProgress();
        }

        window.onload = () => {
            Object.keys(correctFlags).forEach(id => {
                const input = document.getElementById(id);
                const stored = localStorage.getItem(id);
                if (stored) {
                    input.value = stored;
                }
            });
            updateProgress();
        };
    </script>
</body>
</html>
